% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{split_pdf_by_question}
\alias{split_pdf_by_question}
\title{แยก PDF ตามข้อสอบสำหรับการตรวจข้อสอบ}
\usage{
split_pdf_by_question(
  input_pdf,
  n_questions = 4,
  out_dir = ".",
  filename_prefix = "Q",
  filename_suffix = "_all.pdf",
  dry_run = FALSE,
  overwrite = FALSE
)
}
\arguments{
\item{input_pdf}{ชื่อไฟล์ PDF ต้นฉบับที่ต้องการแยก}

\item{n_questions}{จำนวนข้อสอบทั้งหมด (default: 4)}

\item{out_dir}{โฟลเดอร์ปลายทางสำหรับเก็บไฟล์ที่แยกแล้ว (default: ".")}

\item{filename_prefix}{คำนำหน้าชื่อไฟล์ผลลัพธ์ (default: "Q")}

\item{filename_suffix}{คำต่อท้ายชื่อไฟล์ผลลัพธ์ (default: "_all.pdf")}

\item{dry_run}{ทดสอบการทำงานโดยไม่สร้างไฟล์จริง (default: FALSE)}

\item{overwrite}{เขียนทับไฟล์เดิมหากมีอยู่แล้ว (default: FALSE)}
}
\value{
List ที่ประกอบด้วย:
\describe{
  \item{pages_by_question}{Named list ของหมายเลขหน้าที่เป็นของแต่ละข้อ}
  \item{summary}{List ข้อมูลสรุป ประกอบด้วย total_pages, n_questions, n_students, etc.}
}
}
\description{
แยกไฟล์ PDF ที่มีกระดาษคำตอบของนักเรียนหลายคนออกเป็นไฟล์แยกตามข้อสอบ
เหมาะสำหรับกรณีที่สแกนกระดาษคำตอบแบบเรียงลำดับ (นักเรียนคนที่ 1 ทุกข้อ, 
แล้วนักเรียนคนที่ 2 ทุกข้อ, ...)
}
\details{
Split PDF by Question for Exam Grading


ฟังก์ชันนี้ใช้หลักการที่ว่า หากมีนักเรียน n คน และข้อสอบ m ข้อ 
หน้าที่ 1,1+m,1+2m,... จะเป็นข้อที่ 1 ของนักเรียนแต่ละคน
หน้าที่ 2,2+m,2+2m,... จะเป็นข้อที่ 2 ของนักเรียนแต่ละคน
และต่อไปเรื่อยๆ

หากจำนวนหน้าไม่หารลงตัวกับจำนวนข้อสอบ ฟังก์ชันจะแสดง warning
และประมวลผลเฉพาะหน้าที่ครบชุดเท่านั้น
}
\examples{
\dontrun{
# ตัวอย่างการใช้งานพื้นฐาน
result <- split_pdf_by_question("exam_scanned.pdf", n_questions = 4)

# ทดสอบการทำงานก่อน (dry run)
test_result <- split_pdf_by_question(
  "exam_scanned.pdf", 
  n_questions = 4,
  dry_run = TRUE
)
print(test_result$summary)

# การใช้งานแบบกำหนดค่าเต็มรูปแบบ
result <- split_pdf_by_question(
  input_pdf = "midterm_exam_2024.pdf",
  n_questions = 6,
  out_dir = "separated_questions",
  filename_prefix = "Question_",
  filename_suffix = "_AllStudents.pdf",
  overwrite = TRUE
)

# ตรวจสอบผลลัพธ์
cat("แยกได้", length(result$pages_by_question), "ไฟล์\n")
cat("นักเรียนทั้งหมด", result$summary$n_students, "คน\n")
}

}
\seealso{
\code{\link{inspect_pdf_structure}} สำหรับตรวจสอบโครงสร้าง PDF ก่อนแยก
\code{\link{prepare_pdf_for_grading}} สำหรับเตรียมข้อมูลสำหรับ kruroograder
}
